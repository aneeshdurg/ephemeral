<head>
    <style>
        * {
            font-family: tahoma;
        }
    </style>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const nameEl = document.getElementById("name");

            const savedName = localStorage.getItem('name');
            if (savedName) {
                nameEl.value = savedName;
            }

            const savedIdmgmt = localStorage.getItem('idmgmt');
            if (savedIdmgmt) {
                document.getElementById(savedIdmgmt).checked = true;
            }

            document.getElementById("login").onsubmit = e => {
                e.preventDefault();

                const name = nameEl.value;
                localStorage.setItem('name', name);
                sessionStorage.setItem('name', name);
                const idmgmt = document.querySelector(
                    'input[name="idmgmt"]:checked').value;
                if (idmgmt != "createid")
                   localStorage.setItem('idmgmt', idmgmt);
                else
                   localStorage.setItem('idmgmt', "reuseid");
                sessionStorage.setItem('idmgmt', idmgmt);

                if (idmgmt != "guest" && !name)
                    alert("You need a name when creating or reusing an ID");
                else {
                    window.location = "/ephemeral.html";
                }
            };
        });
    </script>
</head>
<body>
    <form id="login">
        <label for="name">Name:</label>
        <input id="name"></input>
        <br>
        <label for="guest">Login as guest</label>
        <input type="radio" id="guest" value="guest" name="idmgmt" checked></input>
        <br>
        <label for="createid">Create ID</label>
        <input type="radio" id="createid" value="createid" name="idmgmt"></input>
        <br>
        <label for="reuseid">Use saved ID</label>
        <input type="radio" id="reuseid" value="reuseid" name="idmgmt"></input>
    </form>
    <button type="submit" form="login" id="start">Connect to Ephemeral!</button>
</body>
